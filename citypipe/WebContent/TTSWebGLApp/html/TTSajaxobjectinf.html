<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
	<meta http-equiv="progma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache,must-revalidate">
	<meta http-equiv="Expires" content="0">
	<title>TTSajaxobjectinf</title>
	<style>
	#outputmsg{
		width:500px;
	}
		#view{
			position:absolute;
			right:0;
			top:0;
			z-index:1;
			border: solid 1px #a0a0a0;
		}
		canvas{
			border: 1px solid #c0c0c0;
		}
	</style>
</head>
<body>
	<div id="input">
	<h2>get object information from object id</h2>
	<h2>table objects stores objectid 1,2,3,4 currently</h2>
	<input  name="id"  style="width:200px" type="Text" value="" id="input_id" placeholder="object id"/>
	<input  name="But_Get"   type="Button" value="Get" id="But_Get" onClick="return ClickEventActionHandlerButGet('/citypipe/ObjectServletInfo');" />
	</div>	
	<div id="outputmsg"></div>	
	<div id="view">
		<canvas id="webgl" width="800" height="600"></canvas>
		<div id="time">time t: <span id = "time_elapsed"></span></div>
		<div>
			<button onclick = clearCanvas()>clear canvas</button>
			<button onclick = resetTime()>reset time</button>
			<button onclick = resetCamera()>reset camera</button>
			<br>
			<button onclick = stopTime() id="stopTime">stop</button>
			<button onclick = startTime() id="startTime">start</button>
		</div>
	</div>
	
	<script src="../javascript/three.min.js"></script>
	<script src="../javascript/TrackballControls.js"></script>
	<script src="../javascript/ClientEventPublicHandler.js"></script>
	<script src="../javascript/TTSDefaultSetting.js"></script>
	<script src="../javascript/TTSObject.js"></script>
	<script>
	function clearCanvas(){
		for(var i = 0 ; i < TTSModels.length; i++){
			TTSModels[i].removeFromScene();
		}
		TTSModels.length = 0;
	}
	function resetTime(){
		last = Date.now();
	}
	function resetCamera(){
		camera.position.set( 10, 10, 50 );
		camera.up.set(0,1,0);
	}
	var pause = false;
	var timestop = null;
	var timestart = null;
	function stopTime(){
		if(timestop === null){
			timestop = Date.now();
			pause = true;
			document.getElementById("stopTime").style.color = "red";
			document.getElementById("startTime").style.color = "green";
		}
	}
	function startTime(){
		if(timestart == null && timestop != null){
		timestart = Date.now();
		last = last + timestart - timestop;
		pause = false;
		timestart = null;
		timestop = null;
		document.getElementById("stopTime").style.color = "black";
		document.getElementById("startTime").style.color = "black";
		}
	}
	var light = new THREE.AmbientLight(0x404040); // add ambient light,soft white light
	scene.add(light);
	var light = new THREE.PointLight(0x808080, 1, 100);//add point light
	light.position.set(10, 10, 50);
	scene.add(light);
	//add object through TTSObject class
	//var obj = new TTSObject(7,'box','0','0',0,1,1,1,0,0,0,0x00ffff,2,5,2);
	//TTSModels.push(obj);
	function render() {
		if(!pause){
			var now = Date.now();
			t = (now - last) * 0.001;
		}
		document.getElementById("time_elapsed").innerHTML = Math.floor(t);
		for(var i = 0 ; i < TTSModels.length; i++){
			TTSModels[i].addToScene(t);
		}
		trackballControl.update();
		renderer.render(scene, camera);
	}
	function animate() {
		requestAnimationFrame(animate);
		render();
	}
	animate();
	</script>
</body>
</html>